\section{Futher Speedup}

\begin{lemma}
$\rho(a,b)$ has lower-bound $\ceil{\frac{b}{d}}$
\end{lemma} 

\begin{proof}
To proof a lower-bound, we show a case whose number of partitions=$\ceil{\frac{b}{d}}$

The case is trivial, divide $a+b$ into $\ceil{\frac{b}{d}}-1$ instances of $d$ and a $a+b-d\ceil{\frac{b}{d}}-1$ (denoted by $s$)

Prove the case avoids $\pa$ by contradiction

If the subset contains $s$ since $s>a$ $\implies$ contradiction

If the subset doesn't contains $s$, it contains only several $d$, but since $d\not| a$ $\implies$ contradiction
\end{proof}

\begin{lemma}
If a multiset $S$ avoids $a$ and composed only by factors of $a$, 

$|S|<a$
\end{lemma}

\begin{proof}

We shall prove this by contradiction

We denote the number of $i$ in $S$ as $X_i$, that is, we have $X_i$ '$i$'(s) in $S$

, the first $k$ elements of $S$ as $S_k$. $S_0$ is the empty set.

We define set $U(s)$ for a multiset $s$ as subset-sums$\leq a$ of $s$. For example, $\pa=5$, $U({1,3,3})=ignore_{>5}(\{ 0,1,3,4,6,7\})=\{ 0,1,3,4\}$

% \begin{remark}
Note that for any $s$, $U(s)$ always include zero.
% \end{remark}

We divide the proof into two sections.

1. $\forall k, |U(P_{k+1})|>|U(P_k)| $ 

Denote $U(P_{k+1})$ as $u'$ and $U(P_k)$ as $u$.

Prove this by contradiction, if $|u'|=|u|$ for some $k$, let $w$ is the k+1th element of $S$,then 
Since $u\subseteq u'$, $u=u'$

$\forall i\geq w, i \in u \implies i+w\in u' \implies i+w\in u$

Since U always include 0, $0\in u \implies tw\in u \forall t$

$w$ is a factor of $\pa$, thus $w\in u$, contradicts $S$ avoids $\pa$

2. We discover $U(S_0)$ to $U(S_{|S|})$, since $U(S_0)=\{0\}$, each time
$U$ at least a new element. If $|S|\geq \pa$, then $U(S)$
must be $\{0,1,...,\pa\}$, contradicts $S$ avoids $\pa$


\end{proof}

\begin{theorem} 
$\forall \pb>d(d+1)(\pa-1)  + (\pa - (\pa\mod d)$, an optimal partition contains at least $\floor{{\frac{\pa}{d}}}$ instances of $d$
\end{theorem}

\begin{proof} 
    Let $S$ is a partition of $\pa+\pb$ avoids $\pa$,   $X_i$ is the number of times $i$ appears in $S$  and  $X = \sum_i{X_i}$  \\  

    Assume $X_d<\lfloor{\frac{\pa}{d}} \rfloor $, \\

    Then 
    \[
    X=\sum_{i<d}{X_i}+X_d+\sum_{i>d}{X_i}
    \]
    Since $\sum_i{X_i\times i}=\pa+\pb$, to maximize $X$, we use as much small number as possible. Hence

    \begin{align*}
    X&\leq \pa-1+ \floor{\frac{\pa}{d}}   +\floor{{\frac{\pb-(\pa - (\pa\mod d))}{d+1}}}\\
     &\leq \pa-1+ \frac{\pa}{d}   +{\frac{\pb-(\pa - (\pa\mod d))}{d+1}}
    \end{align*}
    
    $\forall \pb>d(d+1)(\pa-1) + (\pa - (\pa\mod d)), \\
    X<\pa+\floor{\frac{\pa}{d}} + \pa d -d \leq \ceil{\frac{\pb}{d}}$.    contradicts lemma 4.1

    Hence  S is not optimal
\end{proof}

\begin{theorem}
	$\forall \pb>d(d+1)(\pa-1)  + (\pa - (\pa\mod d)$, $\rho(\pa,\pb+d)=\rho(\pa,\pb)+1$
\end{theorem}

\begin{proof}
    $S$ is a optimal partition of a+b avoids $a$ ($b>d(d+1)(a-1)  + (a - (a\mod d)$)
    
    $S'=S+$'d' is a partition of a+b+d 

    We divide the proof into avoidance part and optimal part

    {\bf(Avoidance)}
    Prove this by contradiction

    If $S'$ has subset-sum $\pa$, $S$ must has subset-sum $\pa$ or $\pa-d$. The former is not possible from definition. 

    If the later happens, $S$ has subset-sum $\pa$ since it has at least $\floor{{\frac{a}{d}}}$ instances of 'd', and $\pa-d$ couldn't has all of them.
    Also contradict definition.

    $S'$ avoids $\pa$.

    {\bf(Optimal)}
        prove by contradiction

        If $S'$ is not optimal there exist an optimal partition $P'$ that $|P'|>|S'|$ and has no subset-sum=$a$

        $P'$ has at least one $d$, let $P=P'-d(sum(P)=sum(S))$ then $P$ has no subset-sum=$a$ and $|P|=|P'|-1>|S'|-1=|S|$, which contradicts $S$ is optimal.

        $S'$ is optimal.

    Thus the theorem holds.
\end{proof}

\begin{corollary}
for a constant $\pa$, $\rho(\pa,\pb)$ forms cycle of length $d$ if $\pb$ is sufficiently large
\end{corollary}

\subsection{Algorithm using cycle property}

let $K=\pa+\pb-kd>d(d+1)a$ (choose maximal $k$, e.g. minimal $K$)

\begin{algorithmic}
  \STATE{$R= \{\pa+\pb\}$}
  \FOR{\textbf{each} partition $P$ of the number K which avoids $\pa$}
    \IF{$|P|>|R|$} \STATE{$R=P$}
    \ENDIF
  \ENDFOR
  \STATE{output $R$+k instances of 'd'}
\end{algorithmic}
check P's avoidence by Dynamic-Programming as solving discrete knapsack problem, keep avoidence vector when enumerating.

Time Complexity:

Denote the number of partitions of $n$ as $p(n)$

Denote the number of partitions avoids $a$ of $n$ as $p_{aoivds\ a}(n)$

\[
O(k+a\times p_{aoivds\ \pa}(K))\\
= O(\pa\times p(K))\\
= O(\pa\frac{exp(\sqrt{\frac{2(1+d(d+1)(\pa-1)+\pa)}{3} } )}{1+d(d+1)(\pa-1)+\pa})
= O(\frac{exp(\sqrt{\frac{2(1+d(d+1)(\pa-1)+\pa)}{3} } )}{d^2})
\]